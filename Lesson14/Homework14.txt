/*1.	Для своей базы данных создайте объект для нахождения общего рейтинга топ 50 продавцов за всю историю продаж, 
где рейтинг определяется количеством баллов за количество продаж в день 
(10 и более продаж – 3 балла, 5-10 – 2 балла, меньше 5 – 1 балл). */

CREATE VIEW dbo.TOP50_Managers_v
AS
SELECT TOP 50 WITH TIES [IDManager], [FirstName], [LastName], SUM (DailyMark) AS TotalRating
FROM 
	(
		SELECT s.[IDManager], [FirstName], [LastName], [DateSales], 
			   COUNT (1) as cnt, 
		       CASE WHEN COUNT(1) < 5 THEN 1
		       WHEN COUNT(1) BETWEEN 5 AND 9 THEN 2
		       WHEN COUNT(1) >=10 THEN 3
		       END DailyMark
	    FROM [dbo].[Sales] s 
			LEFT JOIN [dbo].[Managers] m
			ON m. [IDManager] = s.[IDManager]
		GROUP BY s.[IDManager], [FirstName], [LastName], [DateSales]
	) t
GROUP BY [IDManager], [FirstName], [LastName]
ORDER BY TotalRating DESC


2.	Изучите данные графики. Как можно улучшить каждый? 

График a

•	Сделать столбцы одного цвета
•	Убрать легенду и оставить подписи продуктов под столбцами
•	Убрать тени
•	Сделать жирным текст для подписей столбцов или сделать нежирным цветом подписи кол-ва ккалорий
•	Убрать заливку фона

График b

Общие замечания
•	Убрать 3D графику и тени
•	Убрать значок $ из подписи вертикальной оси
•	Добавить название вертикальной оси
•	Добавить название графика, чтобы было понятно, о каких показателях идет речь
•	Вертикальную ось начинать с нуля и изменить цену деления
•	Манипулирование данными – потому что разница в $5B визуально показана в два раза больше.

А вообще, лучше бы изменить тип диаграммы (например, на круговую), выделив названия TOP 4 (например, если речь идет о компаниях), 
возможно, вклад каждой, показав визуально адекватное соотношение вклада TOP 4 и оставшихся компаний в общем результате. 

График c

•	Не нужно указывать «тыс.» на горизонтальной оси, оставить только числовые значения
•	Изменить шрифты на более читабельные 
•	Присвоить графику адекватное название, оставив только нужную краткую информацию
•	Присвоить горизонтальной и вертикальной оси понятное название. На горизонтальной оси повернуть текст подписи столбцов горизонтально
•	Визуально непонятна разница между столбцами




